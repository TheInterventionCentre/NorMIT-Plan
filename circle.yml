dependencies:
  pre:
    - sudo apt-get update
    - sudo apt-get install cmake3 subversion qt4-qmake libqt4-dev python-dev
    - if [[ ! -e ~/Slicer ]]; then curl https://s3-us-west-1.amazonaws.com/normit-plan.circleci/Slicer.tar.gz | tar xj -C /home/ubuntu; fi
    - if [[ ! -e ~/Slicer-build ]]; then curl https://s3-us-west-1.amazonaws.com/normit-plan.circleci/Slicer-build.tar.gz |tar xj -C /home/ubuntu; fi

compile:
  override:
    - mkdir /home/ubuntu/NorMIT-Plan-build
    - cd /home/ubuntu/NorMIT-Plan-build; cmake ../NorMIT-Plan -DSlicer_DIR=/home/ubuntu/Slicer-build/Slicer-build
    - cd /home/ubuntu/NorMIT-Plan-build; cmake .
    - cd /home/ubuntu/NorMIT-Plan-build; make ExperimentalStart
    - cd /home/ubuntu/NorMIT-Plan-build; make ExperimentalConfigure
    - cd /home/ubuntu/NorMIT-Plan-build; make ExperimentalBuild


test:
  override:
    - cd /home/ubuntu/NorMIT-Plan-build; make ExperimentalTest
    - cd /home/ubuntu/NorMIT-Plan-build; make ExperimentalSubmit
