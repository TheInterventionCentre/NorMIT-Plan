dependencies:
  override:
    - sudo apt-get update
    - sudo apt-get install cmake3 subversion qt4-qmake libqt4-dev python-dev
    - if [[ ! -e ~/Slicer ]]; then curl https://s3-us-west-1.amazonaws.com/normit-plan.circleci/Slicer.tar.gz | tar xj -C /home/ubuntu; fi
    - if [[ ! -e ~/Slicer-Superbuild ]]; then curl https://s3-us-west-1.amazonaws.com/normit-plan.circleci/Slicer-Superbuild.tar.gz |tar xj -C /home/ubuntu; fi
  cache_directories:
    - "/home/ubuntu/Slicer-Superbuild"
    - "/home/ubuntu/Slicer"

compile:
  override:
    - mkdir /home/ubuntu/NorMIT-Plan-build
    - cd /home/ubuntu/NorMIT-Plan-build; cmake ../NorMIT-Plan -DSlicer_DIR=/home/ubuntu/Slicer-Superbuild/Slicer-build
    - cd /home/ubuntu/NorMIT-Plan-build; cmake .
    - cd /home/ubuntu/NorMIT-Plan-build; make ExperimentalStart
    - cd /home/ubuntu/NorMIT-Plan-build; make ExperimentalConfigure
    - cd /home/ubuntu/NorMIT-Plan-build; make ExperimentalBuild

test:
  override:
    - cd /home/ubuntu/NorMIT-Plan-build; make ExperimentalTest
    - cd /home/ubuntu/NorMIT-Plan-build; make ExperimentalSubmit
